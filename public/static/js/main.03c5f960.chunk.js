(this["webpackJsonpm3-client"]=this["webpackJsonpm3-client"]||[]).push([[0],{40:function(e,t,n){},60:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),a=n(33),s=n.n(a),o=n(6),i=n(14),u=(n(40),n(2)),l=n(4),d=n(5),h=n(16),j=n.n(h),p=new(function(){function e(){Object(l.a)(this,e),this.userApi=j.a.create({baseURL:"".concat("https://pottery-store.herokuapp.com/","/api/users"),withCredentials:!0})}return Object(d.a)(e,[{key:"createUser",value:function(e,t,n,r,c,a,s,o,i,u){return this.userApi.post("/create",{role:e,firstName:t,lastName:n,brand:r,email:c,password:a,phone:s,city:o,street:i,postCode:u}).then((function(e){return e.data})).catch((function(e){return console.log("user-service - createUser error => ",e)}))}},{key:"getAllUsers",value:function(){return this.userApi.get("/").then((function(e){return e.data})).catch((function(e){return console.log("user-service - getAllUsers error => ",e)}))}},{key:"getUserById",value:function(e){return this.userApi.get("/".concat(e)).then((function(e){return e.data})).catch((function(e){return console.log("user-service - getUserById error => ",e)}))}},{key:"updateUser",value:function(e,t,n,r,c,a,s,o,i,u,l){return this.userApi.post("/update/".concat(e),{role:t,firstName:n,lastName:r,brand:c,email:a,password:s,phone:o,city:i,street:u,postCode:l}).then((function(e){return e.data})).catch((function(e){return console.log("user-service - updateUser error => ",e)}))}},{key:"deleteUser",value:function(e){return this.userApi.get("/delete/".concat(e)).then((function(e){return e.data})).catch((function(e){return console.log("user-service - deleteUser error => ",e)}))}},{key:"addToCart",value:function(e){return this.userApi.post("/addToCart",{productId:e}).then((function(e){return e.data})).catch((function(e){return console.log("user-service - addToCart error => ",e)}))}},{key:"deleteFromCart",value:function(e){return this.userApi.post("/deleteFromCart",{productId:e}).then((function(e){return e.data})).catch((function(e){return console.log("user-service - deleteFromCart error => ",e)}))}}]),e}()),b=new(function(){function e(){Object(l.a)(this,e),this.auth=j.a.create({baseURL:"https://pottery-store.herokuapp.com/",withCredentials:!0})}return Object(d.a)(e,[{key:"signup",value:function(e,t,n,r,c,a,s,o,i,u){return this.auth.post("/auth/signup",{firstName:e,lastName:t,email:n,password:r,phone:c,street:a,city:s,postCode:o,profilePic:i,brand:u}).then((function(e){return e.data}))}},{key:"login",value:function(e,t){return this.auth.post("/auth/login",{email:e,password:t}).then((function(e){return e.data}))}},{key:"logout",value:function(){return this.auth.get("/auth/logout").then((function(e){return e.data}))}},{key:"me",value:function(){return this.auth.get("/auth/me").then((function(e){return e.data})).catch((function(e){return console.log("auth-service - me error => ",e)}))}}]),e}()),g=n(20),m=n.n(g),f=n(34),O=new(function(){function e(){var t=this;Object(l.a)(this,e),this.deleteOne=function(e){return t.api.delete("/".concat(e))},this.productApi=j.a.create({baseURL:"".concat("https://pottery-store.herokuapp.com/","/api/products"),withCredentials:!0})}return Object(d.a)(e,[{key:"createProduct",value:function(e,t,n,r,c,a){this.productApi.post("/create",{name:e,brandId:t,price:n,materials:r,picture:c,stock:a}).then((function(e){return e.data})).catch((function(e){return console.log("product-service - createProduct error",e)}))}},{key:"getAllProducts",value:function(){return this.productApi.get("/").then((function(e){return e.data})).catch((function(e){return console.log("product-service ! - getAllProducts error",e)}))}},{key:"getProductById",value:function(e){return this.productApi.get("/".concat(e)).then((function(e){return e.data})).catch((function(e){return console.log("product-service - getProductById error",e)}))}},{key:"updateProduct",value:function(e,t,n,r,c,a,s){return this.productApi.post("/update/".concat(e),{name:t,brandId:n,price:r,materials:c,picture:a,stock:s}).then((function(e){return e.data})).catch((function(e){return console.log("product-service - updateProduct error => ",e)}))}}]),e}()),x=(n(60),n(0)),v=function(){var e=Object(r.useState)([]),t=Object(i.a)(e,2),n=t[0],c=t[1];Object(r.useEffect)((function(){a()}),[]);var a=function(){O.getAllProducts().then((function(e){e&&c(e)})).catch((function(e){return console.log(e)}))},s=function(){var e=Object(f.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.addToCart(t);case 2:console.log("estamos en home.js y hemos handleAddCLick(), este es el curent cart ahora");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(x.jsx)("body",{children:Object(x.jsx)("div",{className:"cards",children:n.map((function(e){return Object(x.jsxs)("div",{className:"product-card",children:[Object(x.jsx)("h2",{children:e.name}),Object(x.jsx)("button",{onClick:function(){return s(e._id)},children:Object(x.jsx)("img",{className:"product-img",src:e.picture,alt:"product pic"})}),Object(x.jsxs)("h3",{children:[e.price," \u20ac"]}),Object(x.jsx)("h4",{children:e.description})]})}))})})},y=n(17),C=n(13),L=n(12),k=n(11),I=c.a.createContext(),N=I.Consumer,A=I.Provider,w=function(e){Object(C.a)(n,e);var t=Object(L.a)(n);function n(){var e;Object(l.a)(this,n);for(var r=arguments.length,c=new Array(r),a=0;a<r;a++)c[a]=arguments[a];return(e=t.call.apply(t,[this].concat(c))).state={isLoggedIn:!1,isAdmin:!1,isLoading:!0,user:null},e.signup=function(t,n,r,c,a,s,o,i,u,l,d){b.signup(t,n,r,c,a,s,o,i,u,l,d).then((function(t){"client"===t.role?e.setState({isLoggedIn:!0,user:t,isAdmin:!1}):e.setState({isLoggedIn:!0,user:t,isAdmin:!0})})).catch((function(t){console.log("auth-context - signup error",t),e.setState({isLoggedIn:!1,user:null})}))},e.login=function(t,n){b.login(t,n).then((function(t){"client"===t.role?e.setState({isLoggedIn:!0,user:t,isAdmin:!1}):e.setState({isLoggedIn:!0,user:t,isAdmin:!0})})).catch((function(t){console.log("auth-context - login error => ",t),e.setState({isLoggedIn:!1,user:null})}))},e.logout=function(){b.logout().then((function(){return e.setState({isLoggedIn:!1,user:null})})).catch((function(e){return console.log("auth-context - logout error",e)}))},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this;b.me().then((function(t){"client"===t.role?e.setState({user:t,isLoggedIn:!0,isAdmin:!1,isLoading:!1}):e.setState({user:t,isLoggedIn:!0,isAdmin:!0,isLoading:!1})})).catch((function(t){e.setState({isLoggedIn:!1,user:null,isLoading:!1}),console.log("auth-context - DidMount error => ",t)}))}},{key:"render",value:function(){var e=this.state,t=e.isLoggedIn,n=e.isAdmin,r=e.isLoading,c=e.user,a=this.signup,s=this.login,o=this.logout;return r?Object(x.jsx)("p",{children:"Loading"}):Object(x.jsx)(A,{value:{isLoggedIn:t,isAdmin:n,isLoading:r,user:c,signup:a,login:s,logout:o},children:this.props.children})}}]),n}(c.a.Component),S=function(e){return function(t){return Object(x.jsx)(N,{children:function(n){var r=n.isLoggedIn,c=n.isAdmin,a=n.isLoading,s=n.user,o=n.signup,i=n.login,u=n.logout;return Object(x.jsx)(e,Object(k.a)({isLoggedIn:r,isAdmin:c,isLoading:a,user:s,signup:o,login:i,logout:u},t))}})}},P=S(function(e){Object(C.a)(n,e);var t=Object(L.a)(n);function n(){var e;Object(l.a)(this,n);for(var r=arguments.length,c=new Array(r),a=0;a<r;a++)c[a]=arguments[a];return(e=t.call.apply(t,[this].concat(c))).state={firstName:"",lastName:"",email:"",password:"",phone:"",street:"",city:"",postCode:0,profilePic:"",brand:""},e.handleFormSubmit=function(t){t.preventDefault();var n=e.state,r=n.firstName,c=n.lastName,a=n.email,s=n.password,o=n.phone,i=n.street,u=n.city,l=n.postCode,d=n.profilePic,h=n.brand;e.props.signup(r,c,a,s,o,i,u,l,d,h)},e.handleChange=function(t){var n=t.target,r=n.name,c=n.value;e.setState(Object(y.a)({},r,c))},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this.state,t=e.firstName,n=e.lastName,r=e.email,c=e.password,a=e.phone,s=e.street,i=e.city,u=e.postCode,l=e.profilePic,d=e.brand;return Object(x.jsxs)("div",{children:[Object(x.jsx)("h1",{children:"Sign Up"}),Object(x.jsxs)("form",{onSubmit:this.handleFormSubmit,children:[Object(x.jsx)("label",{children:"First Name:"}),Object(x.jsx)("input",{type:"text",name:"firstName",value:t,onChange:this.handleChange}),Object(x.jsx)("label",{children:"Last Name:"}),Object(x.jsx)("input",{type:"text",name:"lastName",value:n,onChange:this.handleChange}),Object(x.jsx)("label",{children:"Phone:"}),Object(x.jsx)("input",{type:"text",name:"phone",value:a,onChange:this.handleChange}),Object(x.jsx)("label",{children:"Street:"}),Object(x.jsx)("input",{type:"text",name:"street",value:s,onChange:this.handleChange}),Object(x.jsx)("label",{children:"City:"}),Object(x.jsx)("input",{type:"text",name:"city",value:i,onChange:this.handleChange}),Object(x.jsx)("label",{children:"Post code:"}),Object(x.jsx)("input",{type:"number",name:"postCode",value:u,onChange:this.handleChange}),Object(x.jsx)("label",{children:"Profile picture:"}),Object(x.jsx)("input",{type:"text",name:"profilePic",value:l,onChange:this.handleChange}),Object(x.jsx)("label",{children:"Brand name:"}),Object(x.jsx)("input",{type:"text",name:"brand",value:d,onChange:this.handleChange}),Object(x.jsx)("label",{children:"Email:"}),Object(x.jsx)("input",{type:"email",name:"email",value:r,onChange:this.handleChange}),Object(x.jsx)("label",{children:"Password:"}),Object(x.jsx)("input",{type:"password",name:"password",value:c,onChange:this.handleChange}),Object(x.jsx)("input",{type:"submit",value:"Signup"})]}),Object(x.jsx)("p",{children:"Already have account?"}),Object(x.jsx)(o.b,{to:"/login",children:" Login"})]})}}]),n}(r.Component)),U=S(function(e){Object(C.a)(n,e);var t=Object(L.a)(n);function n(){var e;Object(l.a)(this,n);for(var r=arguments.length,c=new Array(r),a=0;a<r;a++)c[a]=arguments[a];return(e=t.call.apply(t,[this].concat(c))).state={username:"",password:""},e.handleFormSubmit=function(t){t.preventDefault();var n=e.state,r=n.username,c=n.password;e.props.login(r,c)},e.handleChange=function(t){var n=t.target,r=n.name,c=n.value;e.setState(Object(y.a)({},r,c))},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this.state,t=e.username,n=e.password;return console.log("user",t),Object(x.jsxs)("div",{children:[Object(x.jsx)("h1",{children:"Login"}),Object(x.jsxs)("form",{onSubmit:this.handleFormSubmit,children:[Object(x.jsx)("label",{children:"Username:"}),Object(x.jsx)("input",{type:"text",name:"username",value:t,onChange:this.handleChange}),Object(x.jsx)("label",{children:"Password:"}),Object(x.jsx)("input",{type:"password",name:"password",value:n,onChange:this.handleChange}),Object(x.jsx)("input",{type:"submit",value:"Login"})]})]})}}]),n}(r.Component)),F=(S(function(e){Object(C.a)(n,e);var t=Object(L.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(x.jsxs)("div",{children:[Object(x.jsx)("h1",{children:"Private Route"}),Object(x.jsxs)("h2",{children:["Welcome ",this.props.user&&this.props.user.username]})]})}}]),n}(r.Component)),n(67),function(){var e=Object(r.useState)([]),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(),s=Object(i.a)(a,2),o=s[0],u=s[1];Object(r.useEffect)((function(){l()}),[]),Object(r.useEffect)((function(){d()}),[]);var l=function(){b.me().then((function(e){var t=e._id;p.getUserById(t).then((function(e){c(e.currentCart)}))}))},d=function(){var e=0;n.forEach((function(t){e+=t.productId.price*t.quantity})),u(e)};return Object(x.jsxs)("div",{className:"cart-wrap",children:["hi this is your cart",n.map((function(e){return Object(x.jsx)("div",{children:Object(x.jsxs)("div",{className:"item-card",children:[Object(x.jsx)("img",{className:"item-img",src:e.productId.picture,alt:"product"}),Object(x.jsxs)("div",{className:"item-info",children:[Object(x.jsxs)("h3",{children:[e.productId.name," ",e.quantity]}),Object(x.jsxs)("h3",{children:[e.productId.price," \u20ac"]})]}),Object(x.jsx)("button",{className:"delete-btn",onClick:function(){return t=e.productId._id,void p.deleteFromCart(t);var t},children:"Delete"})]})},e.productId._id)})),Object(x.jsxs)("div",{className:"total",children:[Object(x.jsxs)("h3",{children:["Total: ",o]}),Object(x.jsx)("button",{className:"checkout-btn",children:"Check out"})]})]})}),B=function(){return Object(x.jsx)("div",{children:"this is the admin page, create products, edit products, delete products, edit profile"})},E=(n(68),S((function(e){var t=e.isAdmin,n=e.cart;return Object(x.jsxs)("nav",{className:"navbar",children:[Object(x.jsx)(o.b,{className:"nav-link",to:"/",id:"home-btn",children:Object(x.jsx)("h4",{children:"Home"})}),e.isLoggedIn?Object(x.jsxs)(x.Fragment,{children:[t?Object(x.jsx)(x.Fragment,{children:Object(x.jsx)(o.b,{to:"/mystore/home",id:"mystore-btn",className:"nav-link",children:Object(x.jsx)("h4",{children:e.user.name.firstName})})}):Object(x.jsx)(x.Fragment,{}),n.length>0?Object(x.jsx)(o.b,{className:"nav-link",to:"/cart",children:Object(x.jsxs)("h4",{children:[" ",Object(x.jsx)("img",{className:"logo",src:"https://img.icons8.com/pastel-glyph/452/fast-cart.png",alt:"cart-logo"}),n.length]})}):Object(x.jsx)("img",{className:"logo",src:"https://img.icons8.com/pastel-glyph/452/fast-cart.png",alt:"cart-logo"}),Object(x.jsx)("button",{onClick:e.logout,children:"Logout"})]}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)(o.b,{to:"/login",children:[Object(x.jsx)("button",{className:"navbar-button",children:"Login"})," "]}),Object(x.jsx)("br",{}),Object(x.jsxs)(o.b,{to:"/signup",children:[Object(x.jsx)("button",{className:"navbar-button",children:"Sign Up"})," "]})]})]})})));var D=S((function(e){var t=e.isLoggedIn,n=e.isLoading,r=e.component,c=e.exact,a=e.path;return n?"Loading":Object(x.jsx)(u.b,{exact:c,path:a,render:function(e){return t?Object(x.jsx)(u.a,{to:"/"}):t?void 0:Object(x.jsx)(r,Object(k.a)({},e))}})}));var T=S((function(e){var t=e.isLoggedIn,n=e.isLoading,r=e.component,c=e.exact,a=e.path;return n?"Loading":Object(x.jsx)(u.b,{exact:c,path:a,render:function(e){return t?t?Object(x.jsx)(r,Object(k.a)({},e)):void 0:Object(x.jsx)(u.a,{to:"/login"})}})}));var _=S((function(e){var t=e.isLoggedIn,n=e.isLoading,r=e.component,c=e.exact,a=e.path;return n?"Loading":Object(x.jsx)(u.b,{exact:c,path:a,render:function(e){return t?t?Object(x.jsx)(r,Object(k.a)({},e)):void 0:Object(x.jsx)(u.a,{to:"/mystore/login"})}})})),R=function(){var e=Object(r.useState)([]),t=Object(i.a)(e,2),n=t[0],c=t[1];Object(r.useEffect)((function(){a()}),[]);var a=function(){b.me().then((function(e){var t=e._id;p.getUserById(t).then((function(e){c(e.currentCart)}))})).catch((function(e){return console.log(e)}))};return Object(x.jsxs)("div",{className:"container",children:[Object(x.jsx)(E,{cart:n}),Object(x.jsxs)(u.d,{children:[Object(x.jsx)(T,{exact:!0,path:"/cart",component:F}),Object(x.jsx)(D,{exact:!0,path:"/login",component:U}),Object(x.jsx)(D,{exact:!0,path:"/signup",component:P}),Object(x.jsx)(u.b,{exact:!0,path:"/",component:v,cart:n}),Object(x.jsx)(_,{exact:!0,path:"/mystore/home",component:B})," "]})]})};s.a.render(Object(x.jsx)(o.a,{children:Object(x.jsx)(w,{children:Object(x.jsx)(R,{})})}),document.getElementById("root"))}},[[69,1,2]]]);
//# sourceMappingURL=main.03c5f960.chunk.js.map